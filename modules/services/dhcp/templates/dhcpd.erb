server-identifier       <%= scope.lookupvar ( 'dhcp::server::variables::dhcp_identifier' ) %>;
ddns-domainname         "<%= scope.lookupvar ( 'dhcp::server::variables::dhcp_domainName' ) %>.";
ddns-rev-domainname     "in-addr.arpa.";
ddns-update-style       interim;
ddns-updates            on;
update-static-leases    on;
do-forward-updates      on;
one-lease-per-client    on;
max-lease-time          <%= scope.lookupvar ( 'dhcp::server::variables::dhcp_maxLeaseTime' )  %>;
default-lease-time      <%= scope.lookupvar ( 'dhcp::server::variables::dhcp_defaultLeaseTime' ) %>;

allow                   client-updates;
allow                   unknown-clients;
allow                   duplicates;

authoritative;


<% scope.lookupvar ( 'dhcp::server::variables::dhcp_subnets' ).each do |subnet| -%>
subnet <%= subnet [ "subnet" ] %> netmask <%= subnet [ "netmask" ] %> {
    range <%= subnet [ "minIp" ] %> <%= subnet [ "maxIp" ] %>
    option subnet-mask <%= subnet [ "subnetMask" ] %>;
    option broadcast-address <%= subnet [ "broadcastAddress" ] %>;
    option routers <%= subnet [ "routers" ] %>;
    option domain-name-servers <%= subnet [ "dnsServers" ] %>;
    option domain-name "<%= subnet [ "domainName" ] %>";
}
<% end -%>

<% scope.lookupvar ( 'dhcp_zones' ).each |zone| -%>
zone <%= zone %>. {
    primary <%= scope.lookupvar ( 'dhcp_dnsServers' ) %>;
}
<% end -%>

